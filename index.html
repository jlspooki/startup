<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>HK Startups — Live Directory</title>
<meta name="description" content="A clean, modern directory for Hong Kong startups. Submit your startup and see it appear instantly." />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#ffffff; --bg-soft:#f6f7f9; --text:#101217; --muted:#6b7280; --border:#e5e7eb;
  --accent:#e6002e; --accent-600:#cc0029; --accent-50:#ffe6ea; --cta-text:#ffffff;
  --card:#ffffff; --shadow:0 6px 24px rgba(16,18,23,.06), 0 2px 8px rgba(16,18,23,.04);
  --radius:16px; --radius-sm:12px; --radius-lg:20px; --container:1120px;
}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;color:var(--text);background:var(--bg);line-height:1.6}
img{max-width:100%;display:block}
a{color:inherit;text-decoration:none}
.container{max-width:var(--container);margin:0 auto;padding:0 20px}

/* Header */
header{position:sticky;top:0;z-index:50;background:rgba(255,255,255,.9);backdrop-filter:blur(10px);border-bottom:1px solid var(--border)}
.nav{display:flex;align-items:center;justify-content:space-between;height:64px}
.brand{display:flex;align-items:center;gap:12px;font-weight:700;font-family:Poppins,Inter,sans-serif;letter-spacing:.2px}
.brand-mark{width:28px;height:28px;border-radius:8px;background:var(--accent);display:grid;place-items:center;color:#fff;font-weight:700;font-size:14px;box-shadow:0 6px 16px rgba(230,0,46,.35)}
.nav-links{display:flex;align-items:center;gap:20px}
.nav-links a{color:var(--muted);font-weight:500}
.nav-links a:hover{color:var(--text)}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:10px;padding:12px 18px;border-radius:12px;font-weight:600;border:1px solid transparent;cursor:pointer;transition:all .18s ease}
.btn-primary{background:var(--accent);color:var(--cta-text);box-shadow:0 10px 24px rgba(230,0,46,.25)}
.btn-primary:hover{background:var(--accent-600);transform:translateY(-1px)}
.btn-ghost{background:#fff;color:var(--text);border-color:var(--border)}
.btn-ghost:hover{border-color:#d1d5db;transform:translateY(-1px)}

/* Hero */
.hero{padding:72px 0}
.hero-grid{display:grid;grid-template-columns:1.05fr .95fr;gap:40px;align-items:center}
.eyebrow{display:inline-flex;align-items:center;gap:10px;color:var(--accent);font-weight:700;letter-spacing:.5px;text-transform:uppercase;font-size:12px;background:var(--accent-50);padding:8px 12px;border-radius:999px}
h1{margin:14px 0 12px;font-family:Poppins,Inter,sans-serif;font-weight:700;line-height:1.12;font-size:clamp(34px,5vw,56px);letter-spacing:-.5px}
.subhead{color:var(--muted);font-size:18px;max-width:560px;margin-bottom:24px}
.hero-cta{display:flex;gap:12px;flex-wrap:wrap}
.mockup{background:linear-gradient(145deg,#ffffff 0%,#f3f4f6 100%);border:1px solid var(--border);border-radius:var(--radius-lg);padding:18px;box-shadow:var(--shadow)}
.mockup-topbar{display:flex;align-items:center;gap:8px;padding-bottom:12px;border-bottom:1px dashed #e9ebef;margin-bottom:16px}
.dot{width:10px;height:10px;border-radius:50%}.dot.red{background:#ff5f57}.dot.amber{background:#ffbd2e}.dot.green{background:#28c840}
.mockup-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}

/* Sections */
section{padding:72px 0}
.section-muted{background:var(--bg-soft)}
.section-title{font-family:Poppins,Inter,sans-serif;font-size:28px;line-height:1.2;margin:0 0 8px}
.section-sub{color:var(--muted);margin:0 0 28px}
.grid{display:grid;gap:16px}
.grid.cols-3{grid-template-columns:repeat(3,1fr)}
.grid.cols-2{grid-template-columns:repeat(2,1fr)}

/* Cards */
.startup-card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:12px;transition:transform .15s ease,box-shadow .15s ease,border-color .15s ease;display:flex;flex-direction:column}
.startup-card:hover{transform:translateY(-2px);box-shadow:var(--shadow);border-color:#d9dbe1}
.logo-wrap{width:40px;height:40px;border-radius:9px;display:grid;place-items:center;font-weight:700;color:#fff}
.tag{display:inline-flex;align-items:center;gap:8px;font-size:12px;color:#0f172a;background:#eef2ff;padding:6px 10px;border-radius:999px;font-weight:600}
.tag svg{width:14px;height:14px}
.card-title{font-weight:700;margin:10px 0 4px}
.card-desc{color:var(--muted);font-size:14px;margin-bottom:10px}
.card-link{color:var(--accent);font-weight:600;font-size:14px}
.card-link:hover{text-decoration:underline}

/* New: services + looking-for + footer */
.services-list{list-style:none;padding:0;margin:8px 0;font-size:14px;color:var(--muted)}
.services-list li{display:flex;align-items:flex-start;gap:6px}
.services-list li::before{content:"•";color:var(--accent)}
.chips{display:flex;flex-wrap:wrap;gap:6px;margin:8px 0}
.chip{font-size:12px;font-weight:600;padding:4px 8px;border-radius:999px;background:var(--accent-50);color:var(--accent)}
.card-footer{margin-top:auto;display:flex;justify-content:space-between;align-items:center;gap:10px}
.meta-small{color:var(--muted);font-size:12px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.card-footer .btn{padding:8px 12px;font-size:14px}

/* Value props */
.value-card{background:#fff;border:1px solid var(--border);border-radius:16px;padding:20px;display:flex;gap:14px;align-items:flex-start}
.icon{width:36px;height:36px;border-radius:10px;background:var(--accent-50);display:grid;place-items:center;color:var(--accent)}
.value-title{font-weight:700;margin:2px 0 6px}
.value-text{color:var(--muted);margin:0}

/* Perks */
.perk{display:flex;gap:12px;align-items:flex-start;background:#fff;border:1px solid var(--border);border-radius:14px;padding:14px}
.check{width:26px;height:26px;border-radius:7px;background:#ecfdf5;color:#059669;display:grid;place-items:center}

/* CTA block */
.cta-band{background:linear-gradient(180deg,#fff 0%,#fff 55%,#f7f7fb 100%);border:1px solid var(--border);border-radius:20px;padding:28px;box-shadow:var(--shadow);text-align:center}
.cta-band h3{font-family:Poppins,Inter,sans-serif;margin:0 0 8px}
.cta-band p{color:var(--muted);margin:0 0 16px}

/* Form */
.cta{background:#fff;border:1px solid var(--border);border-radius:20px;padding:22px;box-shadow:var(--shadow)}
form{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
.full{grid-column:1/-1}
label{display:block;font-weight:600;font-size:14px;margin:0 0 6px}
input,select,textarea{width:100%;padding:12px;border:1px solid var(--border);border-radius:12px;background:#fff;color:var(--text);outline:none;transition:border-color .15s ease,box-shadow .15s ease}
textarea{min-height:80px;resize:vertical}
input:focus,select:focus,textarea:focus{border-color:#cbd5e1;box-shadow:0 0 0 4px rgba(230,0,46,.08)}
.help{color:var(--muted);font-size:12px;margin-top:6px}
#status{margin-top:6px;font-size:14px}

/* Social proof */
.logo-row{display:flex;flex-wrap:wrap;gap:24px;align-items:center;opacity:.8}
.logo-pill{height:36px;padding:0 14px;border:1px solid var(--border);border-radius:999px;display:flex;align-items:center;gap:8px;background:#fff}
blockquote{margin:18px 0 0;padding:16px;border-left:4px solid var(--accent);background:#fff;border-radius:10px}
blockquote p{margin:0} blockquote cite{display:block;margin-top:8px;color:var(--muted);font-style:normal}

/* Footer */
footer{padding:40px 0;border-top:1px solid var(--border);background:#fff}
.foot{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
.foot a{color:var(--muted)}
.socials{display:flex;gap:12px}
.socials a{display:grid;place-items:center;width:36px;height:36px;border:1px solid var(--border);border-radius:10px}
.socials a:hover{border-color:#d1d5db}

/* Responsive */
@media (max-width:960px){
  .hero-grid{grid-template-columns:1fr;gap:28px}
  form{grid-template-columns:1fr}
  .grid.cols-3{grid-template-columns:1fr 1fr}
}
@media (max-width:640px){
  .nav-links .hide-mobile{display:none}
  .grid.cols-3,.grid.cols-2{grid-template-columns:1fr}
  .logo-row{gap:16px}
}
</style>
</head>
<body>

<header role="banner" aria-label="Main">
  <div class="container nav">
    <a class="brand" href="#top" aria-label="Home">
      <div class="brand-mark">HK</div>
      <span>HK Startups</span>
    </a>
    <nav class="nav-links" aria-label="Primary">
      <a class="hide-mobile" href="#directory">Directory</a>
      <a class="hide-mobile" href="#why">Why it matters</a>
      <a class="hide-mobile" href="#perks">Perks</a>
      <a class="btn btn-primary" href="#apply" aria-label="Get listed">Get listed</a>
    </nav>
  </div>
</header>

<main id="top">
  <!-- Hero -->
  <section class="hero">
    <div class="container hero-grid">
      <div>
        <div class="eyebrow">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 2l2.2 5.8L20 10l-5.8 2.2L12 18l-2.2-5.8L4 10l5.8-2.2L12 2z"/></svg>
          Hong Kong Startup Directory
        </div>
        <h1>Get discovered. Connect faster. Grow together.</h1>
        <p class="subhead">Showcase what you're building and let the right people find you — investors, partners, and talent across Hong Kong.</p>
        <div class="hero-cta">
          <a class="btn btn-primary" href="#apply">Add your startup</a>
          <a class="btn btn-ghost" href="#directory">Explore startups</a>
        </div>
      </div>

      <div class="mockup" aria-label="Live preview">
        <div class="mockup-topbar">
          <span class="dot red"></span><span class="dot amber"></span><span class="dot green"></span>
        </div>
        <div id="directory-preview" class="mockup-grid" aria-live="polite">
          <!-- Live preview cards injected by JS -->
        </div>
      </div>
    </div>
  </section>

  <!-- Why it matters -->
  <section id="why" aria-label="Why it matters">
    <div class="container">
      <h2 class="section-title">Why it matters</h2>
      <p class="section-sub">Make it effortless for the ecosystem to find and understand your startup at a glance.</p>

      <div class="grid cols-3">
        <div class="value-card">
          <div class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M10 18a8 8 0 115.293-2.707L22 22l-2 2-6.707-6.707A7.963 7.963 0 0110 18zm0-2a6 6 0 100-12 6 6 0 000 12z"/></svg>
          </div>
          <div>
            <div class="value-title">Get discovered</div>
            <p class="value-text">Show up where investors and operators already look for HK startups.</p>
          </div>
        </div>

        <div class="value-card">
          <div class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M4 14l6-6c3-3 9-4 10-3 1 1 0 7-3 10l-6 6-2-5-5-2zM3 21l4-1-3-3-1 4z"/></svg>
          </div>
          <div>
            <div class="value-title">Accelerate intros</div>
            <p class="value-text">Clear tags, short profiles, quick contact — help the right people reach you faster.</p>
          </div>
        </div>

        <div class="value-card">
          <div class="icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M8 12l2-2 3 3 3-3 5 5-3 3-5-5-3 3-3-3zM1 12l3-3 3 3-3 3-3-3z"/></svg>
          </div>
          <div>
            <div class="value-title">Community first</div>
            <p class="value-text">Built in HK for HK — we highlight local wins and useful tools, not fluff.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Directory -->
  <section id="directory" class="section-muted" aria-label="Live directory">
    <div class="container">
      <h2 class="section-title">Live directory</h2>
      <p class="section-sub">New submissions appear instantly — no redeploys or waiting.</p>
      <div id="directory-list" class="grid cols-3" aria-live="polite">Loading...</div>
    </div>
  </section>

  <!-- Perks -->
  <section id="perks" aria-label="Early member perks">
    <div class="container">
      <h2 class="section-title">Early member perks</h2>
      <p class="section-sub">Founding members get featured placement and early access to upcoming features.</p>

      <div class="grid cols-2">
        <div class="perk">
          <div class="check">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
          </div>
          <div>
            <div class="value-title">Priority placement</div>
            <p class="value-text">Appear at the top of sector pages for the first 90 days.</p>
          </div>
        </div>

        <div class="perk">
          <div class="check">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
          </div>
          <div>
            <div class="value-title">Warm intros</div>
            <p class="value-text">Priority intros to relevant partners and community programs.</p>
          </div>
        </div>

        <div class="perk">
          <div class="check">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
          </div>
          <div>
            <div class="value-title">Beta features</div>
            <p class="value-text">Early access to filtering, saved lists, and basic analytics.</p>
          </div>
        </div>

        <div class="perk">
          <div class="check">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
          </div>
          <div>
            <div class="value-title">Founder spotlight</div>
            <p class="value-text">Monthly features across our socials and newsletter.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA band -->
  <section aria-label="Call to action" class="section-muted">
    <div class="container">
      <div class="cta-band">
        <h3>Ready to get listed?</h3>
        <p>It takes under a minute. Your startup will appear in the directory immediately.</p>
        <a class="btn btn-primary" href="#apply">Submit your startup</a>
      </div>
    </div>
  </section>

  <!-- Application form -->
  <section id="apply" aria-label="Get listed form">
    <div class="container">
      <h2 class="section-title">Get listed today</h2>
      <p class="section-sub">Tell us a little about your startup. We'll add it to the live directory instantly.</p>

      <div class="cta" role="form">
        <form id="startup-form" novalidate>
          <div>
            <label for="name">Your name</label>
            <input id="name" name="Name" type="text" placeholder="E.g., Spooki Chan" required />
          </div>
          <div>
            <label for="email">Work email</label>
            <input id="email" name="Email" type="email" inputmode="email" placeholder="you@startup.hk" required />
          </div>

          <div>
            <label for="company">Company name</label>
            <input id="company" name="Company" type="text" placeholder="Your startup" required />
          </div>
          <div>
            <label for="website">Website</label>
            <input id="website" name="Website" type="url" inputmode="url" placeholder="https://yourstartup.hk" />
          </div>

          <div>
            <label for="role">Your role</label>
            <select id="role" name="Role" required>
              <option value="">Select role</option>
              <option>Founder</option>
              <option>Co-founder</option>
              <option>Ops</option>
              <option>Marketing</option>
              <option>Engineering</option>
              <option>Other</option>
            </select>
          </div>
          <div>
            <label for="sector">Sector</label>
            <select id="sector" name="Sector" required>
              <option value="">Select sector</option>
              <option>Fintech</option>
              <option>AI</option>
              <option>SaaS</option>
              <option>Health</option>
              <option>Climate</option>
              <option>Mobility</option>
              <option>Other</option>
            </select>
          </div>

          <div class="full">
            <label for="desc">One-line description</label>
            <input id="desc" name="Description" type="text" maxlength="140" placeholder="What do you do in one sentence?" required />
            <div class="help">Keep it simple and specific. 140 characters max.</div>
          </div>

          <div class="full">
            <label for="services">Services provided</label>
            <textarea id="services" name="Services" placeholder="Comma-separated e.g. Payments API, Fraud detection, POS integration"></textarea>
            <div class="help">Use commas to separate multiple services.</div>
          </div>

          <div class="full">
            <label for="looking">Looking for</label>
            <textarea id="looking" name="LookingFor" placeholder="Comma-separated e.g. Investor, Collaborator, Pilot customers"></textarea>
            <div class="help">Use commas to separate multiple items.</div>
          </div>

          <div class="full" style="display:flex;gap:10px;align-items:center">
            <button type="submit" class="btn btn-primary">Submit application</button>
            <span id="status" role="status" aria-live="polite"></span>
          </div>
        </form>
      </div>
    </div>
  </section>

  <!-- Social proof -->
  <section aria-label="Social proof and testimonials" class="section-muted">
    <div class="container">
      <h2 class="section-title">Trusted by HK ecosystem folks</h2>
      <p class="section-sub">From co‑working hubs to meetups — the community is watching this space.</p>

      <div class="logo-row" aria-label="Partner logos">
        <div class="logo-pill">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="#9ca3af" aria-hidden="true"><path d="M3 22h18v-2H3v2zM5 18h4V4H5v14zm6 0h8V8h-8v10zM7 6h2v2H7V6zm0 4h2v2H7v-2zm8 2h2v2h-2v-2z"/></svg>
          <span style="color:#6b7280">HarbourWorks</span>
        </div>
        <div class="logo-pill">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="#9ca3af" aria-hidden="true"><path d="M12 2l9 4v6c0 5-4 9-9 10-5-1-9-5-9-10V6l9-4z"/></svg>
          <span style="color:#6b7280">LionRock Angels</span>
        </div>
        <div class="logo-pill">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="#9ca3af" aria-hidden="true"><path d="M4 6h16v2H4V6zm0 5h16v2H4v-2zm0 5h16v2H4v-2z"/></svg>
          <span style="color:#6b7280">Kowloon Tech Meetup</span>
        </div>
        <div class="logo-pill">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="#9ca3af" aria-hidden="true"><path d="M12 3l9 7-1.5 2L12 7 4.5 12 3 10l9-7zM4 13h16v8H4v-8z"/></svg>
          <span style="color:#6b7280">HK Startup Hub</span>
        </div>
      </div>

      <blockquote>
        <p>Clean, fast, and actually useful — exactly what Hong Kong's founders need.</p>
        <cite>— Ada W., Community Lead at HarbourWorks</cite>
      </blockquote>
    </div>
  </section>
</main>

<footer role="contentinfo">
  <div class="container foot">
    <div style="display:flex;align-items:center;gap:10px">
      <div class="brand-mark">HK</div>
      <div style="color:#6b7280">© <span id="year"></span> HK Startups</div>
    </div>
    <div style="display:flex;gap:16px;align-items:center;flex-wrap:wrap">
      <a href="mailto:support@hkstartups.hk">support@hkstartups.hk</a>
      <span aria-hidden="true" style="color:#cbd5e1">•</span>
      <a href="#privacy">Privacy</a>
      <div class="socials" aria-label="Social links">
        <a href="#" aria-label="LinkedIn">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="#6b7280" aria-hidden="true"><path d="M4 3a2 2 0 110 4 2 2 0 010-4zM3 8h3v13H3V8zm7 0h3v2h.1c.4-.8 1.4-1.7 3-1.7 3.1 0 3.9 2 3.9 4.6V21h-3v-6.2c0-1.5 0-3.3-2-3.3s-2.3 1.6-2.3 3.2V21H10V8z"/></svg>
        </a>
        <a href="#" aria-label="X">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="#6b7280" aria-hidden="true"><path d="M4 3l7.3 9.3L4 21h3.3L12 14.7 16.7 21H20l-7.2-8.9L20 3h-3.3L12 9.3 7.3 3H4z"/></svg>
        </a>
        <a href="#" aria-label="Instagram">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="#6b7280" aria-hidden="true"><path d="M7 2h10a5 5 0 015 5v10a5 5 0 01-5 5H7a5 5 0 01-5-5V7a5 5 0 015-5zm0 2a3 3 0 00-3 3v10a3 3 0 003 3h10a3 3 0 003-3V7a3 3 0 00-3-3H7zm5 3a5 5 0 110 10 5 5 0 010-10zm0 2.2A2.8 2.8 0 1014.8 12 2.8 2.8 0 0012 9.2zM18 6.5a1 1 0 110 2 1 1 0 010-2z"/></svg>
        </a>
        <a href="#" aria-label="GitHub">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="#6b7280" aria-hidden="true"><path d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0012 2z"/></svg>
        </a>
      </div>
    </div>
  </div>
</footer>

<script>
// Google Apps Script Web App URL (live)
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzs73U4Ux7S6iPmKpJsTYIdAdAih95QP8jPUcmdW_GNEGw21JUA2n9BJTK5tbOXySBdIA/exec';

// Footer year
document.getElementById('year').textContent = new Date().getFullYear();

// Utilities
function initials(name='?'){
  const parts = String(name).trim().split(/\s+/);
  const first = parts[0]?.[0] || '?';
  const last = parts[1]?.[0] || '';
  return (first + last).toUpperCase().slice(0,2);
}
function colorFromString(str='HK'){
  let hash = 0;
  for (let i=0; i<str.length; i++) hash = str.charCodeAt(i) + ((hash<<5)-hash);
  const hue = Math.abs(hash)%360;
  return `hsl(${hue} 80% 45%)`;
}
function normalizeUrl(url){
  if (!url) return '';
  return /^https?:\/\//i.test(url) ? url : `https://${url}`;
}
function splitCSV(val){
  if (!val) return [];
  return String(val).split(/[,;|]/).map(x=>x.trim()).filter(Boolean);
}

// Enhanced card renderer
function renderCard(s){
  const logoBg = colorFromString(s.Company || s.Name || 'HK');
  const letter = initials(s.Company || s.Name || 'HK');
  const safeDesc = s.Description || '';
  const safeSector = s.Sector || 'Startup';
  const site = normalizeUrl(s.Website);
  const services = splitCSV(s.Services);
  const lookingFor = splitCSV(s.LookingFor);
  const email = (s.Email && /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.Email)) ? s.Email : null;

  return `
    <div class="startup-card">
      <div style="display:flex;gap:10px;align-items:center">
        <div class="logo-wrap" style="background:${logoBg}">${letter}</div>
        <div class="tag">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="#0f172a"><path d="M12 2l2.2 5.8L20 10l-5.8 2.2L12 18l-2.2-5.8L4 10l5.8-2.2L12 2z"/></svg>
          ${safeSector}
        </div>
      </div>
      <div class="card-title">${s.Company || 'New Startup'}</div>
      <p class="card-desc">${safeDesc}</p>
      
      ${services.length ? `
        <ul class="services-list">
          ${services.slice(0,3).map(x=>`<li>${x}</li>`).join('')}
          ${services.length>3 ? `<li>+${services.length-3} more</li>` : ''}
        </ul>
      ` : ''}
      
      ${lookingFor.length ? `
        <div class="chips">
          ${lookingFor.slice(0,4).map(x=>`<span class="chip">${x}</span>`).join('')}
        </div>
      ` : ''}
      
      <div class="card-footer">
        <div class="meta-small">${s.Name || 'Founder'}</div>
        ${site ? `<a class="card-link" href="${site}" target="_blank" rel="noopener">Visit site</a>` : ''}
        ${email ? `<a class="btn btn-ghost" href="mailto:${email}" style="font-size:12px;padding:6px 10px">Contact</a>` : ''}
      </div>
    </div>
  `;
}

// Load directory data
async function loadDirectory(){
  try{
    const res = await fetch(SCRIPT_URL + '?action=get');
    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    const data = await res.json();
    
    if (data && data.length){
      const html = data.map(renderCard).join('');
      document.getElementById('directory-list').innerHTML = html;
      document.getElementById('directory-preview').innerHTML = data.slice(0,3).map(renderCard).join('');
    } else {
      document.getElementById('directory-list').innerHTML = '<p>No startups yet. Be the first to submit!</p>';
    }
  } catch(err){
    console.error('Failed to load directory:', err);
    document.getElementById('directory-list').innerHTML = '<p>Failed to load directory. Please refresh to try again.</p>';
  }
}

// Form submission
document.getElementById('startup-form').addEventListener('submit', async function(e){
  e.preventDefault();
  
  const form = e.target;
  const submitBtn = form.querySelector('button[type="submit"]');
  const statusEl = document.getElementById('status');
  
  // Basic validation
  const required = form.querySelectorAll('[required]');
  let valid = true;
  required.forEach(el => {
    if (!el.value.trim()) valid = false;
  });
  if (!valid){
    statusEl.textContent = 'Please fill all required fields.';
    return;
  }
  
  // Build payload
  const payload = {};
  const fields = ['Name','Email','Company','Website','Role','Sector','Description','Services','LookingFor'];
  fields.forEach(field => {
    const el = form.querySelector(`[name="${field}"]`);
    if (el) payload[field] = el.value.trim();
  });
  
  // Show loading state
  const originalText = submitBtn.textContent;
  submitBtn.textContent = 'Submitting...';
  submitBtn.disabled = true;
  statusEl.textContent = '';
  
  try{
    // Fixed fetch call with correct syntax
    const res = await fetch(SCRIPT_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload)
    });
    
    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    
    const result = await res.text();
    if (result === 'Success'){
      statusEl.textContent = 'Success! Your startup has been added to the directory.';
      statusEl.style.color = 'green';
      form.reset();
      
      // Reload directory after a short delay
      setTimeout(loadDirectory, 1000);
    } else {
      throw new Error(result);
    }
  } catch(err){
    console.error('Submission error:', err);
    statusEl.textContent = 'Error: Could not submit. Please try again.';
    statusEl.style.color = 'red';
  } finally{
    submitBtn.textContent = originalText;
    submitBtn.disabled = false;
  }
});

// Initial load
loadDirectory();
</script>
</body>
</html>
